---
layout: post
categories: fundamental
title: 网络流及相关算法和应用
author: datasnail
show: index
comments: true
intro: 算法预习笔记，绝大部分源从沈孝钧老师《计算机算法基础》，很通俗易懂的一本算法书，没有像算法导论那么巨大，但基本知识都涵盖了。
tags:
- algorithm
---

网络流也是个好东西。 --- 菲克·张作霖
### **一、网络流**

**网络流问题就是在给定的网络中找出一个从源点到汇点的最大流。**   
这里有三个问题，**一个是给定什么样的网络？另一个什么叫流？还一个什么叫最大流？**  
**1、**给定的网络叫**流网络（flow network）**，简称网络；简单来说就是一个加权的简单有向图，边上的权值称为这条边的容量（capacity）。如果某条边不存在可以认为这条边的容量为0，而且图中有两个指定的顶点s和t，分别称为源点和汇点;  
**2、**网络中的一个流$f$，就是给节点间的每条边，例如$(u,v)$，赋以一个**非负实数f(u,v)**，并满足两个条件：①$0≤f(u,v)≤c(u,v)$;②除源点s和汇点t之外任一顶点$u \in V-{s,t}$，有$\sum_{v \in V}f(v,u) = \sum_{v \in V}f(u,v)$。  
第2点的意思就是流量守恒，要求除了源点和汇点之外，其他节点流入的流量等于流出的流量，节点不能私吞流量，即**入流和=出流和**，节点的功能只是转运。  
**3、**网络的最大流问题就是在给定网络中找出一个有最大值的流$f$，这个流就叫最大流。
#### **1、基本概念**
**规范流：**总可以把一对边上的流等量减少，是的有一个方向上的流为零。我们把这个操作称为规范化，规范化后的流称为规范流。  
**相对流：**假设$f$是网络上的一个流，定义边$(u,v)$上的相对流$\phi(u,v)=f(u,v)-f(v,u)$；可以看出相对流就是一条边的净流入或者净流出。  
**割(cut)：**网络中的一个割（S,T）就是把顶点结合V划分为两个不相交子集S和T；一个**割的容量**定义为所有送S里的点到T里的点的边的容量之和；被割穿过的边也称为**穿越边**。  
<span style='color:red'>**一个割的容量大小与流量无关！**即使是最大流最小割定理也只是**存在相等**的关系！</span>网络中有最小流量的割（S,T），称为网络的**最小割**。  
最大流最小割定理：设$f$是网络上的一个最大流，那么一定**存在**一个割$（S,T）$使得$|f|=c(S,T)$,并且这个割是最小的。

#### **2、最大流的问题算法**
1、**Ford-Fulkerson**算法  
先找到G的一个流，然后不断的在剩余网络中找打一条增广路径把当前这个流增广，直到找不到增广路径为止。    
2、**Edmonds-Karp**算法  
每次找增广路径都找最短的。  
3、**Dinic**算法  
每次找增广路径不仅找最短的，而且在剩余网络中找所有的最短增广路径。

#### **3、二部图的匹配问题**
匹配问题定义：如果$M \subset E$是图$G(V,E)$的一个边集合，并且M中任意两条边都不共享同一个顶点，则称为一个**匹配**。如果边$(u,v)\in M$，则称顶点u和v相配。如果一个匹配M包含的边的个数|M|是所有匹配中最多的，则称M为一个**最大匹配**。  
有很多实际问题可以建模为二部图匹配问题。  
例如**工作分配问题**：

> 集合$T={t_1,t_2,...,t_n}$代表n个工作需要分配，耳机和$P={p_1,p_2,...,p_m}$代表m个人要申请工作。假设任何一个工作职能录取一个人，而每个申请工作的人也最多职能得到一个工作，怎样才能让最多的申请者得到工作呢？

**构造过程：**我们可以把这个问题建模为一个二部图G(U,W,E)的最大匹配问题。用n个顶点的集合$U={u_1,u_2,...,u_n}$代表n个工作，其中$u_i$代表工作$t_i$，$1≤i≤n$。再用m个顶点集合$W={w_1,w_2,...,w_m}$代表m个申请人，其中$w_j$代表$p_j$，$1≤j≤m$。集合U和W组成这两个二部图的顶点集合。现在，如果申请工作$t_i$的人中有$p_j$，则构造一条边$(u_i,w_j)$。显然这个图的一个匹配对就对应于一个工作分配的解，因此一个最大匹配就是一个最佳解。

还有一个**活动安排问题**：

> 假设有一个场馆，n个活动，每个活动有起始时间s和结束时间f，假设时间被分成若干个时间槽，而活动可以被安排在起始时间范围内的任一个时间槽，求此场馆能安排的最大活动数量和安排方案。

这个问题可以用[贪心算法求解](/fundamental/2018/07/01/algorithms_01.html)，但是此处用最大流算法求解。  
**构造方法：** 仍然可以把这个问题建模为二部图G(U,W,E)的最大匹配问题。用n个顶点的集合$U={u_1,u_2,...,u_n}$代表n个活动，其中$u_i$代表活动$a_i$，$1≤i≤n$。再用m个顶点集合$W={w_1,w_2,...,w_m}$代表m个时间槽，其中$w_j$代表$t_j$，$1≤j≤m$。集合U和W组成二部图的两个顶点集合。至此，如果活动$a_i$的起止时间内包含时间槽$t_j$，则构造一条边$(u_i,w_j)$。显然这个图的一个匹配对就对应于一个活动安排的解，因此一个最大匹配问题就是一个最佳解。  
寻找G(U,V,E)的最大匹配问题可以转换为一个单分支网络的最大流问题，具体做法如下：
1. 赋以G中每条边从U指向W的方向得到一个有向图G'；
2. 在G'中加上一个源点s并且对U中每个点u加上有向边(s,u)；
3. 在G'中加上一个汇点t并且对W中每个点w加上有向边(w,t)；
4. 赋以图中每条边的容量为1。

使用最大流求解算法，例如Edmonds-Karp算法即可得到以上解。

**用网络流求二部图的最大匹配算法的理论依据**

### **三、参考文献**

[1] 沈孝钧. 计算机算法基础 : Essentials of computer algorithms[M]. 机械工业出版社, 2014.